<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Aeroporto   di   Bari  -  Gruppo  21: Riferimenti per il file prenotazione.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Aeroporto   di   Bari  -  Gruppo  21
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generato da Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Cerca');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Cerca');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('prenotazione_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Funzioni</a>  </div>
  <div class="headertitle">
<div class="title">Riferimenti per il file prenotazione.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &quot;<a class="el" href="prenotazione_8h_source.html">prenotazione.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="passeggero_8h_source.html">passeggero.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="volo_8h_source.html">volo.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="menu_8h_source.html">menu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="controlli_8h_source.html">controlli.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Funzioni</h2></td></tr>
<tr class="memitem:a04c3d07188feef0e4b16f8a5292c0e71"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prenotazione_8c.html#a04c3d07188feef0e4b16f8a5292c0e71">prenotaVolo</a> (FILE *voli, FILE *passeggeri)</td></tr>
<tr class="memdesc:a04c3d07188feef0e4b16f8a5292c0e71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Librerie necessarie per il corretto funzionamento del programma.  <a href="#a04c3d07188feef0e4b16f8a5292c0e71">Continua...</a><br /></td></tr>
<tr class="separator:a04c3d07188feef0e4b16f8a5292c0e71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a315fbf4481da0e8f9075a610eb219628"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prenotazione_8c.html#a315fbf4481da0e8f9075a610eb219628">checkin</a> (FILE *voli, FILE *passeggeri)</td></tr>
<tr class="separator:a315fbf4481da0e8f9075a610eb219628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a045510394d1e05fa2d7254f2fc494162"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prenotazione_8c.html#a045510394d1e05fa2d7254f2fc494162">modificaPrenotazione</a> (FILE *passeggeri, int id_utente)</td></tr>
<tr class="separator:a045510394d1e05fa2d7254f2fc494162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86dda93023d5f1b60ae34d6b92c5842b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prenotazione_8c.html#a86dda93023d5f1b60ae34d6b92c5842b">ricercaPrenotazione</a> (FILE *passeggeri)</td></tr>
<tr class="separator:a86dda93023d5f1b60ae34d6b92c5842b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a5ffb8f9d9f058d61caf2264d08162a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="prenotazione_8c.html#a8a5ffb8f9d9f058d61caf2264d08162a">ordinamentoPrenotazioni</a> (FILE *passeggeri)</td></tr>
<tr class="separator:a8a5ffb8f9d9f058d61caf2264d08162a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Descrizione dettagliata</h2>
<div class="textblock"><p>Questo file contiene le implementazioni dei prototipi dichiarati nel file <a class="el" href="prenotazione_8h.html">prenotazione.h</a> </p><dl class="section version"><dt>Versione</dt><dd>1 </dd></dl>
<dl class="section date"><dt>Data</dt><dd>13/05/2019 </dd></dl>
<dl class="section author"><dt>Autori</dt><dd>Gianmarco Scarano </dd></dl>
</div><h2 class="groupheader">Documentazione delle funzioni</h2>
<a id="a315fbf4481da0e8f9075a610eb219628"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a315fbf4481da0e8f9075a610eb219628">&#9670;&nbsp;</a></span>checkin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int checkin </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>voli</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>passeggeri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>La funzione, dopo un login valido da parte dell'utente, chiede un codice prenotazione. Essa è capace di verificare se quel codice prenotazione esiste o meno. Se esiste, procede con l'assegnazione di un posto per quel volo. Se non esiste, richiede un nuovo codice. La funzione ha codice F09</p>
<dl class="section pre"><dt>Precondizione</dt><dd>La funzione richiede che il file dei voli e passeggeri, esistano.</dd></dl>
<dl class="section post"><dt>Postcondizione</dt><dd>La funzione può far ritornare l'utente al menù, dopo aver sbagliato tre volte il codice prenotazione. Se l'utente inserisce un codice prenotazione valido, allora procede con l'assegnazione di un posto. </dd></dl>
<p>Struct volo</p>
<p>Struct passeggero</p>
<p>Variabile che userò per immagazzinare l'ID dell'utente da modificare.</p>
<p>Serie di variabili contatori che mi serviranno per uscire dai cicli se il dato richiesto è giusto.</p>
<p>Variabile che userò per convertire l'ID dell'utente da char a int.</p>
<p>Ricavo l'ID dell'ultimo utente tramite la funzione <a class="el" href="passeggero_8c.html#ae766664acc6f174203967f006291f025" title="Includo le librerie necessarie per il corretto funzionamento del programma. ">ID_Utente()</a> e lo immagazzino nella variabile "id", la quale mi servirà successivamente.</p>
<p>Variabile che servirà a dire se il codice di prenotazione esiste.</p>
<p>Variabile che servirà a dire se il codice di prenotazione non esiste.</p>
<p>Variabile che mi servirà a contenere il posto per l'utente</p>
<p>Variabile per trovare la giusta posizione nel vettore "prenotazione" dentro la struct passeggero.</p>
<p>Variabile che conterrà la giusta posizione nel vettore "prenotazione" dentro la struct passeggero.</p>
<p>Contatore che mi conta quanti posti sono stati occupati. Se il contatore arriva a 150, significa che tutti gli utenti si sono imbarcati.</p>
<p>Vettore su cui memorizzare il passaporto immesso dall'utente al momento del login.</p>
<p>Vettore su cui memorizzare il codice prenotazione immesso dall'utente al momento del login.</p>
<p>Finchè correct1 non è uguale a 1, ciclo.</p>
<p>Trasformo in intero l'ID immesso precedentemente</p>
<p>Se l'utente ha immesso un ID uguale a 0 oppure se il "numero_utente" &gt; della variabile "id" (Che contiene l'ID dell'ultimo utente), allora stampa un errore.</p>
<p>Resetto il vettore dell'ID immesso dall'utente.</p>
<p>Tramite isalpha() controllo se sono stati inseriti due caratteri alfabetici.</p>
<p>Finchè correct2 è diverso da 1, ciclo</p>
<p>La funzione <a class="el" href="controlli_8c.html#a233801499f59e57e8cecd5a290f05f3e">ControlloPassaportoTemporaneo()</a>, restituisce 1 o 0. Se è 1 (significa che il passaporto è stato inserito correttamente) posso uscire dalla funzione, altrimenti farò ripetere il tutto.</p>
<p>Le prime due lettere del passaporto devono essere maiuscole Es. AA1234567</p>
<p>Confronto il passaporto precedentemente immesso con il passaporto dell'utente pescato con la fseek(), sempre precedentemente.</p>
<p>Necessario per una if successiva.</p>
<p>Se entro nell'else, il passaporto non coincide.</p>
<p>Resetto correct2, altrimenti non entro</p>
<p>nel ciclo di input del passaporto.</p>
<p>Se il passaporto coincide, allora vado avanti con il codice prenotazione.</p>
<p>La funzione <a class="el" href="controlli_8c.html#ab235ffe5fb8886ae9e6f5d596a15a052">ControlloCodicePrenotazione()</a>, restituisce 1 o 0. Se è 1 (significa che il codice è stato inserito correttamente) posso uscire dalla funzione, altrimenti farò ripetere il tutto.</p>
<p>Le prime due lettere del codice prenotazione devono essere maiuscole. Es. AA123</p>
<p>Se il codice è stato correttamente inserito, vado avanti.</p>
<p>Scorro tutto il vettore delle prenotazione dell'utente</p>
<p>Controllo se il codice inserito precedentemente coincide con almeno uno presente nel vettore di prenotazioni dell'utente.</p>
<p>Se coincide, copio la giusta posizione del vettore prenotazione in una variabile chiamata "codice", che userò successivamente.</p>
<p>Aumento il contatore dei "trovati".</p>
<p>Se al primo for non trovo il codice prenotazione richiesto, aumento il contatore dei "non trovati". Ciclo così per tutto il for.</p>
<p>Se ha trovato almeno una corrispondenza, allora procedo a vedere se l'utente ha già effettuato questo check-in tramite un flag che diventa 1 al momento della prenotazione. Uso "codice" come indice del vettore, perchè quando trovo l'occorrenza, copio "num" in "codice".</p>
<p>Resetto tutte le variabili dei vari cicli e resetto i vettori temporanei.</p>
<p>Il check-in è andato a buon fine, quindi esco da tutti i cicli e proseguo con l'assegnamento del posto.</p>
<p>Qui ci entrerò solamente se il contatore dei "non trovati" è uguale al massimo di prenotazioni disponibili. Significa che non esiste un codice prenotazione tale.</p>
<p>Resetto tutte le variabili dei vari cicli e resetto i vettori temporanei.</p>
<p>Tramite fseek(), mi sposto al giusto utente e sempre tramite offset, mi sposto al membro giusto (in questo caso è p[codice].elenco.posti) per poter scrivere il posto e l'effettiva riuscita del check-in.</p>
<p>Finchè correct4 è diverso da 1, ciclo.</p>
<p>Variabile per leggere tutto il file</p>
<p>Quando read arriva a 0, significa che il file è finito.</p>
<p>Confronto il codice volo della prenotazione, con il codice volo di tutti i voli presenti nel sistema. Dato che il codice volo è unico, una volta trovata la coincidenza, andrò ad inserire un posto random per quel volo e lo occuperò tramite funzione booleana.</p>
<p>Genere un numero random da 0 a 150.</p>
<p>Finchè quel posto è uguale ad 1 (significa che è stato già preso), cicla.</p>
<p>Occupo il posto per questo utente ed esco dal ciclo.</p>
<p>Tramite fseek(), mi posiziono al volo giusto tramite "elenco.id", dopo di che mi muovo nel giusto membro (elenco.posti).</p>
<p>Controllo, scorrendo il vettore, se tutti i posti sono stati presi</p>
<p>Se contatore_posti arriva a 150 (MAX_POSTI), allora tutti gli utenti per quel volo, hanno effettuato il check-in.</p>
<p>Una volta aggiornato il file, lo chiudo</p>
<p>Esco dal ciclo</p>
<p>Scrivo il posto dell'utente su file</p>
<p>Tramite fseek(), mi sposto al giusto utente e sempre tramite offset, mi sposto al membro giusto (in questo caso è p[codice].posto) per poter scrivere il posto assegnato all'utente.</p>
<p>Copio il posto generato nella variabile posto, all'interno del vettore prenotazione.</p>
<p>Scrivo su file e chiudo.</p>
<p>Tramite fseek(), mi sposto al giusto utente e sempre tramite offset, mi sposto al membro giusto (in questo caso è p[codice].controllo_checkin) per poter constatare l'effettivo check-in.</p>
<p>Gli assegno 1, in modo tale che nel caso in cui l'utente dovesse rifare il check-in, non gli sarà permesso dato che il controllo del check-in per questa prenotazione è impostato ad 1. </p>

</div>
</div>
<a id="a045510394d1e05fa2d7254f2fc494162"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a045510394d1e05fa2d7254f2fc494162">&#9670;&nbsp;</a></span>modificaPrenotazione()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int modificaPrenotazione </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>passeggeri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id_utente</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>La funzione, la quale non ha bisogno di un login (dato che ha come parametro di input l'ID dell'utente), chiede un codice prenotazione. Essa è capace di verificare se quel codice prenotazione esiste o meno. Se esiste, procede con la modifica del posto (qui, ulteriori controlli su un posto già assegnato sono implementati) per quella prenotazione o può addirittura cancellare la prenotazione stessa. La funzione ha codice F07</p>
<dl class="section pre"><dt>Precondizione</dt><dd>La funzione richiede che il file dei passeggeri, esista.</dd></dl>
<dl class="section post"><dt>Postcondizione</dt><dd>La funzione può modificare/cancellare una prenotazione con successo se il codice prenotazione esiste. Se l'utente inserisce un codice prenotazione non valido, l'algoritmo lo segnalerà. </dd></dl>
<p>Struct passeggero</p>
<p>Struct volo</p>
<p>Dichiaro una variabile di tipo file, che mi servirà per i voli.</p>
<p>Contatore che mi permetterà di uscire dal ciclo while.</p>
<p>Variabile equivalente ad una carattere "barra spaziatrice".</p>
<p>Variabile equivalente al carattere "new line", ovvero "invio".</p>
<p>Variabile dove memorizzare quanti "spazi" ci sono in una stringa.</p>
<p>Variabile che userò per verificare se l'utente ha già una prenotazione o meno.</p>
<p>Variabile che userò per verificare se l'utente ha già una prenotazione o meno.</p>
<p>Immagazzino cosa l'utente ha scelto in questa variabile</p>
<p>Serie di variabili contatori che mi serviranno per uscire dai cicli se il dato richiesto è giusto.</p>
<p>Vettore su cui memorizzare il codice prenotazione immesso dall'utente al momento del login.</p>
<p>Vettore su cui memorizzare il posto che l'utente desidera immettere al momento della modifica della prenotazione.</p>
<p>Variabile che servirà a dire se il codice di prenotazione non esiste.</p>
<p>Variabile che servirà a dire se il codice di prenotazione esiste.</p>
<p>Variabile per trovare la giusta posizione nel vettore "prenotazione" dentro la struct passeggero.</p>
<p>Variabile che conterrà la giusta posizione nel vettore "prenotazione" dentro la struct passeggero.</p>
<p>Se il file non esiste, stampa un messaggio di errore.</p>
<p>Finchè s è uguale a 1, eseguo il loop.</p>
<p>Immagazzino la scelta nella variabile scelta_utente.</p>
<p>Programmazione difensiva che cattura i caratteri, nel caso in cui l'amministratore abbia immesso dei caratteri invece dei numeri. Converto i caratteri in numeri e li faccio ricadere nel "default" della switch, stampando un messaggio d'errore.</p>
<p>Switch per controllare cosa l'utente ha immesso</p>
<p>La funzione <a class="el" href="controlli_8c.html#ab235ffe5fb8886ae9e6f5d596a15a052">ControlloCodicePrenotazione()</a>, restituisce 1 o 0. Se è 1 (significa che il codice è stato inserito correttamente) posso uscire dalla funzione, altrimenti farò ripetere il tutto.</p>
<p>Le prime due lettere del codice prenotazione devono essere maiuscole. Es. AA123</p>
<p>Se il codice è stato correttamente inserito, vado avanti.</p>
<p>Scorro tutto il vettore delle prenotazione dell'utente</p>
<p>Controllo se il codice inserito precedentemente coincide con almeno uno presente nel vettore di prenotazioni dell'utente.</p>
<p>Se coincide, copio la giusta posizione del vettore prenotazione</p>
<p>in una variabile chiamata "codice", che userò successivamente.</p>
<p>Aumento il contatore dei "trovati".</p>
<p>Se al primo for non trovo il codice prenotazione richiesto,</p>
<p>aumento il contatore dei "non trovati". Ciclo così per tutto il for.</p>
<p>Se ha trovato almeno una corrispondenza, allora procedo a vedere se l'utente ha già effettuato questo check-in tramite un flag che diventa 1 al momento della prenotazione. Uso "codice" come indice del vettore, perchè quando trovo l'occorrenza, copio "num" in "codice".</p>
<p>Tramite fseek(), mi posiziono all'utente giusto tramite "numeroutente", dopo di che mi muovo nel giusto membro (utenti.numeropassaporto).</p>
<p>Converto più semplicemente in intero, il posto scelto dall'utente</p>
<p>Controllo se l'utente ha inserito un posto non valido. Max. 150, min 0.</p>
<p>Controllo se alla posizione [0]-[1]-[2] del vettore, c'è un carattere alfabetico.</p>
<p>Scorrimento e controllo vettore</p>
<p>Se trova uno spazio, aumenta la variabile "spazio" di 1.</p>
<p>Per poter verificare se ci sono due spazi, la variabile "spazio" deve essere almeno pari a 2.</p>
<p>Controllo se alla posizione [0] del vettore, c'è uno spazio. Il che significa che l'utente ha inserito la barra spaziatrice come primo carattere.</p>
<p>Se la if è verificata, stampo a video un messaggio d'errore ed esco dalla funzione con correct = 0, e ripeto tutta la funzione.</p>
<p>Stampa un messaggio di errore se all'inizio è stato immesso un carattere new line. Controllo solo la prima posizione del vettore con il carattere "\n".</p>
<p>Se la if è verificata, esco dalla funzione con correct = 0 e ripeto il tutto.</p>
<p>Variabile per leggere tutto il file</p>
<p>Quando read arriva a 0, significa che il file è finito.</p>
<p>Confronto il codice volo della prenotazione, con il codice volo di tutti i voli presenti nel sistema. Dato che il codice volo è unico, una volta trovata la coincidenza, andrò ad inserire un posto random per quel volo e lo occuperò tramite funzione booleana.</p>
<p>Se il valore di quell'indice del vettore è pari ad 1, significa che il posto è già stato preso.</p>
<p>Occupo il posto per questo utente ed esco dal ciclo.</p>
<p>Tramite fseek(), mi posiziono al volo giusto tramite "elenco.id", dopo di che mi muovo nel giusto membro (elenco.posti).</p>
<p>Una volta aggiornato il file, lo chiudo</p>
<p>Tramite fseek(), mi sposto al giusto utente e sempre tramite offset, mi sposto al membro giusto (in questo caso è p[codice].posto) per poter scrivere il posto assegnato all'utente.</p>
<p>Copio il posto scelto dall'utente nella variabile val, all'interno del vettore prenotazione.</p>
<p>Scrivo su file e chiudo.</p>
<p>Qui ci entrerò solamente se il contatore dei "non trovati" è uguale al massimo di prenotazioni disponibili. Significa che non esiste un codice prenotazione tale.</p>
<p>Resetto tutte le variabili dei vari cicli e resetto i vettori temporanei.</p>
<p>La funzione ha codice F07a</p>
<p>La funzione <a class="el" href="controlli_8c.html#ab235ffe5fb8886ae9e6f5d596a15a052">ControlloCodicePrenotazione()</a>, restituisce 1 o 0. Se è 1 (significa che il codice è stato inserito correttamente) posso uscire dalla funzione, altrimenti farò ripetere il tutto.</p>
<p>Le prime due lettere del codice prenotazione devono essere maiuscole. Es. AA123</p>
<p>Se il codice è stato correttamente inserito, vado avanti.</p>
<p>Scorro tutto il vettore delle prenotazione dell'utente</p>
<p>Controllo se il codice inserito precedentemente coincide con almeno uno presente nel vettore di prenotazioni dell'utente.</p>
<p>Se coincide, copio la giusta posizione del vettore prenotazione</p>
<p>in una variabile chiamata "codice", che userò successivamente.</p>
<p>Aumento il contatore dei "trovati".</p>
<p>Se al primo for non trovo il codice prenotazione richiesto,</p>
<p>aumento il contatore dei "non trovati". Ciclo così per tutto il for.</p>
<p>Se ha trovato almeno una corrispondenza, allora procedo a vedere se l'utente ha già effettuato questo check-in tramite un flag che diventa 1 al momento della prenotazione. Uso "codice" come indice del vettore, perchè quando trovo l'occorrenza, copio "num" in "codice".</p>
<p>Tramite fseek(), mi posiziono all'utente giusto tramite "numeroutente", dopo di che mi muovo nel giusto membro (utenti.numeropassaporto).</p>
<p>La cancellazione è andata a buon fine, quindi esco da tutti i cicli.</p>
<p>Qui ci entrerò solamente se il contatore dei "non trovati" è uguale al massimo di prenotazioni disponibili. Significa che non esiste un codice prenotazione tale.</p>
<p>Resetto tutte le variabili dei vari cicli e resetto i vettori temporanei.</p>
<p>Apro il file in sola lettura.</p>
<p>Mi posizione tramite fseek(), all'utente che ha effettuato il login.</p>
<p>Controllo che l'utente non sia stato eliminato, verificando se l'ID è diverso da 0 e verificando che all'interno del vettore nome, ci sia qualcosa di diverso dal carattere nullo</p>
<p>Stampa dell'utente</p>
<p>Finche correct3 è diverso da 1, ciclo.</p>
<p>Trasformo in interi l'orario di arrivo e l'orario di partenza della prenotazione[num] contenuta nella struct passeggero.</p>
<p>Per verificare se un utente ha una prenotazione disponibile, controllo se l'orario di arrivo (Es. 18), precedentemente convertito in intero, è minore di MAX_ORA_VOLO (23). Verifico la stessa cosa per l'orario di partenza. Se le due condizioni combaciano, allora significa che nel vettore p[num], esiste una prenotazione, quindi la stampo.</p>
<p>Controllo se l'utente ha effettuato il check-in per questa prenotazione tramite un flag che sarà uguale ad 1 solo nel caso in cui l'utente effettua il check-in.</p>
<p>Passo alla prossima prenotazione. Se prima p[num], era p[0], ora sarà p[1]. In questo caso ricontrollo se l'utente ha un'altra prenotazione.</p>
<p>Esco subito dal ciclo non appena l'algoritmo non trova una prenotazione disponibile.</p>
<p>Inizializzo il vettore usato per la ricerca e tutte le altre variabili per una eventuale nuova ricerca.</p>
<p>Chiamata alla funzione che mi porta al menu precedente (menu utente).</p>
<p>Rendo vero il valore della while e termino il programma con exit(0).</p>
<p>Qui ricadranno tutti i valori non corretti. (caratteri e num &gt; 9). </p>

</div>
</div>
<a id="a8a5ffb8f9d9f058d61caf2264d08162a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a5ffb8f9d9f058d61caf2264d08162a">&#9670;&nbsp;</a></span>ordinamentoPrenotazioni()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ordinamentoPrenotazioni </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>passeggeri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>La funzione, tramite un algoritmo di ordinamento, ordina in ordine alfabetico tutte le prenotazioni registrate nel sistema. La funzione ha codice F14.</p>
<dl class="params"><dt>Parametri</dt><dd>
  <table class="params">
    <tr><td class="paramname">passeggeri</td><td>File dei passeggeri </td></tr>
  </table>
  </dd>
</dl>
<p>Se il file non esiste, stampa un messaggio di errore.</p>
<p>Variabile per trovare la giusta posizione nel vettore "prenotazione" dentro la struct passeggero.</p>
<p>Variabile che mi permette la lettura del file. Quando read = 0, allora la lettura è finita.</p>
<p>Variabile che mi permette di sapere quante prenotazioni ci sono nel sistema.</p>
<p>Variabile che userò per verificare se l'utente ha già una prenotazione o meno.</p>
<p>Variabile che userò per verificare se l'utente ha già una prenotazione o meno.</p>
<p>Variabile che mi permetterà di uscire dal ciclo</p>
<p>Struct passeggero</p>
<p>Apro il file in sola lettura.</p>
<p>Leggi il file finchè read non arriva a 0.</p>
<p>Quando read arriva a 0, significa che il file è finito.</p>
<p>Finchè correct2 non è uguale a 1, cicla.</p>
<p>Trasformo in interi l'orario di arrivo e l'orario di partenza della prenotazione[num] contenuta nella struct passeggero.</p>
<p>Per verificare se un utente ha una prenotazione disponibile, controllo se l'orario di arrivo (Es. 18), precedentemente convertito in intero, è minore di MAX_ORA_VOLO (23). Verifico la stessa cosa per l'orario di partenza. Se le due condizioni combaciano, allora significa che nel vettore p[num], esiste una prenotazione.</p>
<p>Aumento il contatore delle prenotazioni</p>
<p>Passo alla prossima prenotazione. Se prima p[num], era p[0], ora sarà p[1]. In questo caso ricontrollo se l'utente ha un'altra prenotazione.</p>
<p>Esco subito dal ciclo non appena l'algoritmo non trova una prenotazione disponibile.</p>
<p>Resetto le variabili</p>
<p>Chiudo il file</p>
<p>Sorting</p>
<p>Vettore dinamico delle prenotazioni. E' grande tanto quanti sono le prenotazioni</p>
<p>Funzione qsort(). Mi ordina il vettore precedentemente dichiarato per prenotazioni, in ordine alfabetico. Riferirsi alla documentazione.</p>
<p>Fine Sorting</p>
<p>Stampa le prenotazioni ordinate</p>
<p>Non stampare utenti cancellati. </p>

</div>
</div>
<a id="a04c3d07188feef0e4b16f8a5292c0e71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04c3d07188feef0e4b16f8a5292c0e71">&#9670;&nbsp;</a></span>prenotaVolo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int prenotaVolo </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>voli</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>passeggeri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Librerie necessarie per il corretto funzionamento del programma. </p>
<p>La funzione, chiede il login all'utente. Successivamente chiede quale volo prenotare e lo assegna all'utente, fornendogli un codice prenotazione. La funzione ha codice F06</p>
<dl class="section pre"><dt>Precondizione</dt><dd>La funzione richiede che il file dei voli e passeggeri, esistano.</dd></dl>
<dl class="section post"><dt>Postcondizione</dt><dd>La funzione può far ritornare l'utente al menù, dopo aver sbagliato tre volte la prenotazione del volo (l'utente sbaglia se immette un volo già prenotato). Se l'utente sceglie un volo non prenotato, allora la funzione procede con la prenotazione. </dd></dl>
<p>Struct dei voli</p>
<p>Struct dei passeggeri</p>
<p>Variabile che userò per immagazzinare l'ID dell'utente da modificare.</p>
<p>Variabile che userò per immagazzinare l'ID dell'utente da modificare.</p>
<p>Serie di variabili contatori che mi serviranno per uscire dai cicli se il dato richiesto è giusto.</p>
<p>Valore che indica se una prenotazione è già stata effettuata o meno.</p>
<p>Contatore che mi permette di ritornare al menu una volta arrivato a 0.</p>
<p>Contatore che, nel caso arrivi a 10, significa che l'utente ha tutte le prenotazioni piene</p>
<p>Variabile per trovare la giusta posizione nel vettore "prenotazione" dentro la struct passeggero.</p>
<p>Variabile che immagazzinerà la scelta del volo.</p>
<p>Variabile che userò per convertire l'ID dell'utente da char a int.</p>
<p>Ricavo l'ID dell'ultimo utente tramite la funzione <a class="el" href="passeggero_8c.html#ae766664acc6f174203967f006291f025" title="Includo le librerie necessarie per il corretto funzionamento del programma. ">ID_Utente()</a> e lo immagazzino nella variabile "id", la quale mi servirà successivamente.</p>
<p>Vettore su cui memorizzare il passaporto da confrontare con quello dell'utente, al momento del login.</p>
<p>Variabile che userò per convertire l'ID del volo da char a int.</p>
<p>Finchè correct è diverso da 1, cicla.</p>
<p>Finchè correct5 è diverso da 1, cicla.</p>
<p>Trasformo in intero l'ID immesso precedentemente</p>
<p>Se l'utente ha immesso un ID uguale a 0 oppure se il "numero_utente" &gt; della variabile "id" (Che contiene l'ID dell'ultimo utente), allora stampa un errore.</p>
<p>Resetto il vettore dell'ID immesso dall'utente.</p>
<p>Tramite isalpha() controllo se sono stati inseriti due caratteri alfabetici.</p>
<p>Esco dal ciclo, se l'input è corretto.</p>
<p>Attraverso la fseek(), mi sposto all'utente scelto tramite numero_utente</p>
<p>Finchè correct2 è diverso da 1, cicla.</p>
<p>La funzione <a class="el" href="controlli_8c.html#a233801499f59e57e8cecd5a290f05f3e">ControlloPassaportoTemporaneo()</a>, restituisce 1 o 0. Se è 1 (significa che il passaporto è stato inserito correttamente) posso uscire dalla funzione, altrimenti farò ripetere il tutto.</p>
<p>Le prime due lettere del passaporto devono essere maiuscole Es. AA1234567</p>
<p>Confronto il passaporto precedentemente immesso con il passaporto dell'utente pescato con la fseek(), sempre precedentemente.</p>
<p>Esco dal ciclo principale.</p>
<p>Resetto il vettore del passaporto temporaneo e riporto correct2 a 0, altrimenti non entrerà nella while del correct2.</p>
<p>Scorro tutto il vettore delle prenotazioni e controllo se il codice volo per la prenotazione [i], sia diverso dal carattere nullo. Nel caso in cui sia diverso dal carattere nullo (ovvero che il codice volo esiste), allora aumento il contatore delle prenotazioni.</p>
<p>Confronto tra codice volo e carattere nullo</p>
<p>Nella if ci entrerò solamente quando le prenotazioni sono uguali a 10. Se la if è verificata significa che l'utente ha tutte le prenotazioni già occupate, quindi esco con return 0.</p>
<p>Leggo fino alla fine del file</p>
<p>Quando read arriva a 0, significa che il file è finito.</p>
<p>Stampo i voli solamente se il codice_volo è diverso da 0 e il nome della compagnia non ha un nome pari a NULL.</p>
<p>Finchè correct4 è diverso da 1, ciclo.</p>
<p>Trasformo in intero l'ID volo immesso precedentemente</p>
<p>Tramite fseek(), mi posiziono al volo giusto.</p>
<p>Controllo che la scelta dell'utente sia giusta Es. - Ci sono 6 voli, l'utente sceglie il volo numero 7 In quel caso, stampo errore.</p>
<p>Se l'utente sceglie un volo che non esiste oppure digita 0, stampa errore e ripeti il processo.</p>
<p>Scorro il vettore delle prenotazioni dell'utente. Se trovo che il codice_volo del volo scelto precedentemente, coincide con un codice volo presente nelle 15 prenotazioni dell'utente, allora stampo un messaggio di errore</p>
<p>Aumento il contatore delle prenotazioni già effettuate.</p>
<p>All'inizio wrong sarà uguale a 3.</p>
<p>Quando wrong raggiungerà 0, allora mostrerò il menu.</p>
<p>Stampo le rimanenti possibilità dell'utente</p>
<p>Quando wrong raggiunge 0, rimando l'utente al menù.</p>
<p>Se nel caso non c'è nessuna prenotazione già effettuata per un volo x, allora procedo nel trovare un indice di prenotazione (p.[num]) disponibile su cui scrivere la prenotazione stessa.</p>
<p>Finchè correct3 è diverso da 1, cicla.</p>
<p>Trasformo in interi l'orario di arrivo e l'orario di partenza della prenotazione[num] contenuta nella struct passeggero.</p>
<p>Per verificare se un utente ha una prenotazione disponibile, controllo se l'orario di arrivo (Es. 18), precedentemente convertito in intero, è minore di MAX_ORA_VOLO (23). Verifico la stessa cosa per l'orario di partenza. Se le due condizioni combaciano, allora significa che nel vettore p[num], esiste una prenotazione, quindi aumento la variabile "num" e ripeto il processo.</p>
<p>Alla fine troverò un "num" disponibile, e uscirò dai 2 cicli,</p>
<p>Mi sposto, tramite fseek(), all'utente giusto e tramite l'offset, anche al membro giusto (in questo caso "elenco", poichè devo scrivere l'intero volo nel vettore di prenotazioni). Poi lo scrivo su file.</p>
<p>Chiudo entrambi i file</p>
<p>Mi sposto, tramite fseek(), all'utente giusto e tramite l'offset, anche al membro giusto (in questo caso "codice_prenotazione").</p>
<p>Genero un codice prenotazione e lo copio nel membro codice_prenotazione.</p>
<p>Scrivo solamente il vettore delle prenotazioni, precisamente solo il membro "codice_prenotazione".</p>
<p>Chiudo tutti i file aperti. </p>

</div>
</div>
<a id="a86dda93023d5f1b60ae34d6b92c5842b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86dda93023d5f1b60ae34d6b92c5842b">&#9670;&nbsp;</a></span>ricercaPrenotazione()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ricercaPrenotazione </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>passeggeri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>La funzione, la quale non ha bisogno di un login (dato che ricerca un codice prenotazione tra tutti quelli esistenti), chiede un codice prenotazione all'utente e verifica se quel codice prenotazione è inserito nel sistema o meno. Se esiste, procede con la stampa dell'utente per quella prenotazione altrimenti mostra all'utente un messaggio di errore. La funzione ha codice F12</p>
<dl class="section pre"><dt>Precondizione</dt><dd>La funzione richiede che il file dei passeggeri, esista.</dd></dl>
<dl class="section post"><dt>Postcondizione</dt><dd>La funzione mostra l'utente per quella prenotazione o può mostrare un messaggio di errore se il file o la prenotazione non esiste. </dd></dl>
<p>Struct passeggero</p>
<p>Variabile contatore che mi permetterà di uscire dai cicli se il dato richiesto è giusto.</p>
<p>Variabile che mi permette la lettura del file. Quando read = 0, allora la lettura è finita.</p>
<p>Variabile che servirà a dire se il codice di prenotazione esiste.</p>
<p>Vettore su cui memorizzare il codice prenotazione immesso dall'utente al momento del login.</p>
<p>La funzione <a class="el" href="controlli_8c.html#ab235ffe5fb8886ae9e6f5d596a15a052">ControlloCodicePrenotazione()</a>, restituisce 1 o 0. Se è 1 (significa che il codice è stato inserito correttamente) posso uscire dalla funzione, altrimenti farò ripetere il tutto.</p>
<p>Le prime due lettere del codice prenotazione devono essere maiuscole. Es. AA123</p>
<p>Ritorno 0 se il file non esiste.</p>
<p>Leggi il file finchè read non arriva a 0.</p>
<p>Quando read arriva a 0, significa che il file è finito.</p>
<p>Scorro tutto il vettore delle prenotazioni per ogni utente presente nel sistema. Se il codice immesso dall'amministratore, coincide con uno presente nel vettore delle prenotazioni, allora stampo l'utente relativo a quella prenotazione.</p>
<p>Aumento il contatore delle prenotazioni trovate</p>
<p>Entro nella if solo se ha trovato almeno 1 prenotazione</p>
<p>Entro nella if solo se non ha trovato nessuna prenotazione </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="prenotazione_8c.html">prenotazione.c</a></li>
    <li class="footer">Generato da
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
